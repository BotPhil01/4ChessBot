/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst BOARDDIMENSION = 14;\nwindow.onload = function () {\n    console.log(\"starting up\");\n    buttons();\n};\nfunction buttons() {\n    var h = document.getElementById(\"homeSwap\");\n    if (h) {\n        h.onclick = swap;\n    }\n    var bb = document.getElementById(\"boardBackButton\");\n    if (bb) {\n        bb.onclick = swap;\n    }\n    var db = document.getElementById(\"debugButton\");\n    if (document.getElementById(\"draggable\")) {\n        console.log(\"dragging element\");\n        dragPieceElement(\"draggable\");\n    }\n}\n// func for swapping between home and game pages\nfunction swap() {\n    console.log(\"swapping\");\n    let gameDiv = document.getElementById(\"gameDiv\");\n    let homeDiv = document.getElementById(\"homeDiv\");\n    console.log(`${gameDiv}`);\n    // mandatory error handling by ts\n    if (!homeDiv || !gameDiv) {\n        console.error(\"No divs founds\");\n        return;\n    }\n    if (homeDiv.getAttribute(\"class\") == \"centered\" && gameDiv.getAttribute(\"class\") == \"destroy\") {\n        homeDiv.setAttribute(\"class\", \"destroy\");\n        gameDiv.setAttribute(\"class\", \"block\");\n    }\n    else {\n        homeDiv.setAttribute(\"class\", \"centered\");\n        gameDiv.setAttribute(\"class\", \"destroy\");\n    }\n}\n// func for dragging pieces\n// uses ts event handling no libraries needed\nfunction dragPieceElement(elementId) {\n    var element = document.getElementById(elementId);\n    var initialSquare;\n    var initialPos;\n    if (!element) {\n        console.error(`Unable to retrieve element <${elementId}>`);\n        return;\n    }\n    element.onmousedown = startDrag;\n    function setInitialSquare(square) {\n        initialSquare = square;\n    }\n    function setInitialPosition(pos) {\n        initialPos = pos;\n    }\n    // takes position of the element relative to viewport\n    function positionToSquare(position) {\n        //TODO optimise this function to use global variables instead of recalculating\n        var boardElement = document.getElementById(\"boardImage\");\n        if (!boardElement) {\n            console.error(\"unable to find board element\");\n            return [-1, -1];\n        }\n        var boardRect = boardElement.getBoundingClientRect();\n        const squareLength = (boardRect.right - boardRect.left) / BOARDDIMENSION;\n        // make position relative to board\n        position[0] -= boardRect.left;\n        position[1] -= boardRect.top;\n        // remove position relative to the square \n        var square = [-1, -1];\n        square[0] = Math.floor(position[0] / squareLength);\n        square[1] = Math.floor(position[1] / squareLength);\n        return square;\n    }\n    // returns psoition relative to viewport\n    function positionFromSquare(square) {\n        //TODO optimise this function to use global variables instead of recalculating\n        var boardElement = document.getElementById(\"boardImage\");\n        if (!boardElement) {\n            console.error(\"unable to find board element\");\n            return [-1, -1];\n        }\n        var boardRect = boardElement.getBoundingClientRect();\n        const squareLength = (boardRect.right - boardRect.left) / BOARDDIMENSION;\n        var position = [-1, -1];\n        position[0] = boardRect.left + square[0] * squareLength;\n        position[1] = boardRect.top + square[1] * squareLength;\n        return position;\n    }\n    // triggered by onmousedown\n    function startDrag(e) {\n        if (!element) {\n            console.error(\"trying to move non existent element\");\n            return;\n        }\n        // cache initial position and square in case needed to return there\n        var elemRect = element.getBoundingClientRect();\n        setInitialPosition([elemRect.left, elemRect.top]);\n        e.preventDefault();\n        document.onmouseup = stopDrag;\n        document.onmousemove = elementDrag;\n        return true;\n    }\n    // triggered when moving\n    function elementDrag(ev) {\n        ev.preventDefault();\n        if (element) {\n            // elemenet midpoint binds to cursor position\n            element.style.top = (ev.clientY - (element.offsetHeight / 2)) + \"px\";\n            element.style.left = (ev.clientX - (element.offsetWidth / 2)) + \"px\";\n            return true;\n        }\n        console.error(\"Element has been clicked dragged and disappeared\");\n        return false;\n    }\n    // triggered by on mouse up\n    function stopDrag(ev) {\n        snapToBoard([ev.clientX, ev.clientY]);\n        document.onmouseup = null;\n        document.onmousemove = null;\n        return true;\n    }\n    // takes position of element relative to the viewport and snaps it to the board element if element is over a valid square \n    function snapToBoard(position) {\n        if (!element) {\n            console.error(\"Unable to find elements in snapToBoard function\");\n            alert(\"something went wrong with the board see console for details\");\n            return;\n        }\n        var square = positionToSquare(position);\n        // check if piece can move there\n        if (!elemCanMove(initialSquare, square)) {\n            console.log(`returning to initial position: ${initialPos[0]},${initialPos[1]}`);\n            // return to intitial space \n            element.style.left = initialPos[0] + \"px\";\n            element.style.top = initialPos[1] + \"px\";\n            return;\n        }\n        // calculate pixel coords to move to\n        position = positionFromSquare(square);\n        console.log(`moving to pos: ${position[0]},${position[0]}`);\n        element.style.left = position[0] + \"px\";\n        element.style.top = position[1] + \"px\";\n        setInitialPosition(position);\n    }\n    // validates if an element can move from a valid to square to a potentially invalid square\n    function elemCanMove(fromSquare, toSquare) {\n        // check square bounds\n        // general bounds\n        var outGeneralBounds = toSquare[0] > 13 || toSquare[0] < 0 || toSquare[1] > 13 || toSquare[1] < 0;\n        var inCorners = toSquare[0] < 3 && (toSquare[1] < 3 || toSquare[1] > 10) ||\n            toSquare[0] > 10 && (toSquare[1] < 3 || toSquare[1] > 10);\n        if (outGeneralBounds || inCorners) {\n            return false;\n        }\n        return true;\n    }\n}\n\n\n//# sourceURL=webpack://4pchess/./src/index.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/index.js"](0, __webpack_exports__);
/******/ 	
/******/ })()
;